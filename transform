#!/usr/bin/env bash

case $1 in
	phone|telephone)
		shift
		# Default variant
		variant="parentheses"
		while getopts ":v:" opt; do
		  case ${opt} in
			v)
			  variant=$OPTARG
			  ;;
			\?)
			  echo "Invalid option: -$OPTARG" 1>&2
			  exit 1
			  ;;
			:)
			  echo "Option -$OPTARG requires an argument." 1>&2
			  exit 1
			  ;;
		  esac
		done
		shift $((OPTIND -1))
		phone_number=$(echo "$1" | tr -cd '[:digit:]')
		# Check if phone number is a digit
		if ! [[ $phone_number =~ ^[0-9]+$ ]]; then
			echo "Invalid phone number: Phone number must be a digit"
			exit 1
		fi
		case $variant in
			parentheses|parenthetical|paren)
				echo "$phone_number" | sed -r 's/([0-9]{3})([0-9]{3})([0-9]{4})/(\1) \2-\3/'
				;;
			hyphens|hyphenated|dashes|dashed)
				echo "$phone_number" | sed -r 's/([0-9]{3})([0-9]{3})([0-9]{4})/\1-\2-\3/'
				;;
			dots|dotted|periods)
				echo "$phone_number" | sed -r 's/([0-9]{3})([0-9]{3})([0-9]{4})/\1.\2.\3/'
				;;
			spaces|spaced)
				echo "$phone_number" | sed -r 's/([0-9]{3})([0-9]{3})([0-9]{4})/\1 \2 \3/'
				;;
			plain|raw|none|clean)
				echo "$phone_number"
				;;
			*)
				echo "Invalid phone format"
				;;
		esac
		;;
	*)
		case $1 in
			uppercase|upper)
				echo "$2" | tr '[:lower:]' '[:upper:]'
				;;
			lowercase|lower)
				echo "$2" | tr '[:upper:]' '[:lower:]'
				;;
			capitalize|capitalized|caps)
				echo "$2" | awk '{for(i=1;i<=NF;i++){$i=toupper(substr($i,1,1))tolower(substr($i,2))}}1'
				;;
			*)
				echo "Invalid text format"
				;;
		esac
		;;
esac