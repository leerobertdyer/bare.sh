#!/usr/bin/env bash

# Check if a file argument is provided
[ $# -eq 0 ] && {
	echo "Usage: ./interpret <script-name>"
	exit 1
}

# Ensure script name does not contain path traversal characters
script_name=$(basename "$1")

# Check if the script file exists in ./scripts/<script-name>.bare
[ ! -f "./scripts/${script_name}.bare" ] && {
	echo "Error: script file ./scripts/${script_name}.bare not found"
	exit 1
}

# Prepend shebang and PATH export, then execute the script
{
	printf '#!/usr/bin/env bash\nexport PATH="$PATH:."\n'
	cat "./scripts/${script_name}.bare"
} | bash -s -- "$@"
